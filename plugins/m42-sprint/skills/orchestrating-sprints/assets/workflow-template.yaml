# Workflow Template
# Copy to: .claude/workflows/<your-workflow>.yaml

name: custom-workflow
description: Brief description of this workflow's purpose

phases:
  # Simple phase - direct prompt execution
  - id: setup
    prompt: |
      Setup phase instructions.
      Use {{sprint.id}} for sprint context.

  # For-each phase - iterates over items from named collection
  - id: main
    for-each: step               # Collection name (exact match with collections.step)
    workflow: feature-standard   # Reference another workflow

  # Simple phase with quality gate
  - id: validate
    prompt: |
      Run validation and verify quality.
    gate:
      script: "npm test && npm run lint"
      on-fail:
        prompt: "Fix failing tests or lint errors."
        max-retries: 3

  # Breakpoint phase - pauses for human review
  - id: review-checkpoint
    prompt: |
      Summarize all changes for human review.
    break: true  # Sprint pauses here (status: paused-at-breakpoint)

  # Simple phase
  - id: finalize
    prompt: |
      Finalization instructions.

# Template variables available:
# {{item.prompt}} - Item description from collection
# {{item.id}} - Item identifier (e.g., step-0, feature-1)
# {{item.index}} - 0-based item index
# {{item.<prop>}} - Any custom property from the item
# {{<type>.prompt}} - Type-specific variant (e.g., {{feature.prompt}})
# {{phase.id}} - Current phase identifier
# {{sprint.id}} - Sprint identifier

# Phase options:
# break: true - Pause execution after phase for human review
# gate: { script, on-fail: { prompt, max-retries } } - Quality gate check
